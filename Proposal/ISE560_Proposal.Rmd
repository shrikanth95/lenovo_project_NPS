---
title: "ISE 560 Project Proposal"
author: "Shawn Markham, Melissa Wong, Shrikanth Yadav & Lekhana Yennam"
date: \today
header-includes:
   - \usepackage{fontspec}
   - \setmainfont{Times New Roman}
   - \usepackage{setspace}
   - \onehalfspacing
   - \usepackage{enumitem}
output: 
  pdf_document:
    latex_engine: xelatex
    number_sections: true
    fig_caption: true
fontsize: 12pt
geometry: margin=1in 
urlcolor: blue
---

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(out.width="50%")
knitr::opts_chunk$set(fig.align = "center")

library(tidyverse)
```

# Overview

Lenovo is an international company and a market leader in the personal computer industry.  One tool Lenovo relies upon in assessing customer satisifaction is Net Promoter Score (NPS); this is a standard metric used by major corporations across many industries.  However, latency is a limitation because it can take several months to aggregate sufficient data to calculate NPS.  Therefore Lenovo wants to determine if near-real-time data such as customer ratings and comments from websites and telemetry can accurately predict NPS.  If accurate predictions are possible, then Lenovo can potentially take actions (e.g., deploying out of cycle software patches) more quickly which will lead to higher NPS scores in the future.

## Model

We propose developing a linear regression model using the Product Sentiment Index (PSI) as one of the explanatory variables. The PSI will be modeled as a stochastic process which will help Lenovo better understand the evolution of both PSI and NPS over time.  Based on a preliminary analysis of the data (see Section \ref{data_analysis}), star rating, product series and telemetry data are additional potential explanatory variables for the model.   

## Metrics

We propose using k-fold cross validation to evaluate candidate models as follows:
\begin{enumerate}[nosep]
  \item Randomly shuffle the data and split into k-groups.
  \item For each group
  \begin{enumerate}[nosep]
    \item Reserve the current group as the test data set.
    \item Fit candidate model(s) to the remaining k-1 data sets and perform variable selection.
    \item Assess model fit with the test data set.
  \end{enumerate}
\end{enumerate}

Assuming we develop multiple candidate models, then we will use the results from the cross-validation to  make a final recommendation.  This approach gives us additional flexibility; for example, the final recommendation may be two models with different explanatory variables for the Commercial and Consumer segments versus a single model with the same explanatory variables for both business segments.

# NPS & Telemetry
   Net Promotor Score (NPS) is a management tool that measures customer satisfaction, as well as customer loyalty. The score is based entirely on the customer’s response to the question “How likely are you to recommend this product (or service) to someone else?” Their response is a number on the scale of zero (being the least likely) to ten (being the most likely). Companies then categorize the customers based off the scores they inputted. If a customer’s NPS response score was between a nine and a ten, the customer is called a promoter. If the customer’s response was low, between zero and six, they are called a detractor. The company’s NPS score is calculated by subtracting the percentage of detractors from the percentage of promoters. 
   Every industry has a different NPS average and this number can give a company a good indication of how loyal their customers are compared to other companies. Customer loyalty is crucial because companies spend less money keeping current customers than marketing to attract new customers. Within the laptop and tablet industry, the average NPS score is a 40. Apple has the most loyal and satisfied customers with an NPS score of 68. Lenovo is above the industry average of 40 and by leveraging customer reviews and telemetry data to make changes to their products they can potentially improve their average NPS score in order to beat Apple.
   Telemetry data is system performance data that is captured as soon as a device is turned on. This data is captured by Microsoft and then sent to Lenovo. Lenovo can then analyze this data to determine meaningful information about their machines. Telemetry is crucial within the laptop industry because it gives companies insight on which features their customers are using the most, enabling them to determine the most important features and shape future models based off of these statistics. Analyzing Telemetry data can also help Lenovo determine which devices are malfunctioning or experiencing bugs. For instance, if the data shows that seventy percent of Lenovo ThinkPad’s are crashing every two hours, Lenovo may need to provide some type of update or even recall the machine. In this same example where a customer is experiencing crashes every two hours, it is likely that they will answer the question “How likely are you to recommend this product (or service) to someone else?” with a low NPS score and be identified as a detractor. For this reason, telemetry has a great potential for predicting NPS score and we will incorporate the driver, battery, and Wi-Fi connectivity data findings into our predictive models. 


# Key Variables and Parameters
The models created will be based off of several variables including the evolution of sentiment, stars, business class, and product family. 
Parameters?

Identify and describe critical uncertainties within the model with regards to parameters and decision variables. Identify those uncertainties that may be dynamic (stochastic). 

  - Three variables of interest
    - pNPS 
    - PSI and Star rating
    - Telemetry
  - Discretize probabilities. 
  - We are given time series data for two years.  
  
# Critical Uncertainties

# Markov Decision Process
The states that can be used to develop a Markov Chain include NPS states and star rating states. We have categorized NPS into five states. These five states are very low, moderately low, normal, moderately high, and very high. We will call a NPS score in the range of -100 to 8, very low. Scores that fall in the range of 8-35 will be considered moderately low. The normal NPS range will be from 35 to 45 and the range of 45-60 will be considered high. Lastly, a NPS score that falls between 60-100 will be considered very high. The star ratings are rated on a 1-5 scale. Star ratings that are either a 1 or 2 will be considered a negative state, 3 will be considered a neutral state, and 4 or 5 will be considered a positive state.

State              | Range          |
----------         | -------------- | 
Moderately Low NPS | -100-8         |
Normal NPS         |  8-35          |
Moderately High NPS|  35-45         |
Very High NPS      |  45-60         |
Negative Star      |  60-100        |
Neutral Star       |  1,2           |
Positive Star      |  3             | 
Very Low NPS       |  4,5           |



# Preliminary Data Analysis \label{data_analysis}


Segment    | Total Products | w/Sentiment and NPS | w/Battery 
---------- | -------------- | ------------ | ------- 
Consumer   | 487            |      74          | TBD     
Commercial | 238            |      46          | TBD     
SMB        |   59           |      18          | TBD     

Figure \ref{fig:overall_summary} provides a broad overview of the trends within pNPS, PIS and the star rating.  Note that pNPS was calculated using the given formula.  PIS was calculated by:

\begin{equation}
PIS = \frac{\text{Positive mentions}- \text{Negative mentions}}{\text{Positive mentions}+ \text{Negative mentions}}\times 100.
\end{equation}
The period of interest is one month.  Star ratings are averaged over a month for each segment. In order to observe trends, star rating is scaled by a multiplicative factor of 20.  Further note that as ownership durating is avaiable only for the surveys, the PIS and Star rating per segment will be identical in each facet.  
  
\begin{figure}[t]
  \centering
  \includegraphics[width = 0.48\textwidth]{Figures/all_metric_summary_consumer.pdf}
  \includegraphics[width = 0.48\textwidth]{Figures/all_metric_summary_commercial.pdf}
  \caption{Trends in the pNPS, PIS and average star rating when downsamped at 1-month intervals.}
  \label{fig:overall_summary}
\end{figure}


## Customer Sentiment

## Telemetry





